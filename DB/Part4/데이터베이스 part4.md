# 데이터베이스 part4

## 7장 Entity-Relationship Data Model(객체 관계형 데이터 모델)
7장과 8장은 '데이터 베이스 구조 설계를 어떻게 할 것인가'에 대해 다룰 것.

### ER Model이란?
`Entity`와 `Relationship`으로 이루어진 데이터베이스

#### Entity
- 데이터베이스에 저장하고자 하는 무엇, 대상.
- 속성을 가진다.
- 같은 속성을 모은 것을 `Entity Set`이라 칭한다.

#### Relationship
- `Entity` 간의 연관성.
- 속성을 가진다.
- 같은 속성의 `Relationship`들을 모은 것을 `Relationship Set`

### Keys
- `슈퍼키`는 엔티티를 유니크하게 만들어줌.
- 그 중에서 가장 적은 것이 `후보키`.
- `후보키` 중 하나가 `기본키`거 됨.

### Roles
`Entity Set`에 속하는 `Entity` 간의 관계를 정의하는 것. 예를 들어, **수강 과목 간의 선행 관계** 또는 **사람들 간의 남편, 부인 관계**가 된다.

### Weak Entity Set
`기본키`가 없는 `Entity Set`을 일컫는다. 예를 들어, 수강 분반이 될 수 있다. '수강 분반'은 1반, 2반... 이런 식으로 정해지기 때문에 그 자체로 구별되지 않는다. 대신 '수강 과목'과 연결시켜주면 `Strong`해 진다.

### Reduction of ER Model
관계형 데이터베이스로 변환하는 것.

- 기본적으로 `Entity Set`과 `Relationship Set`은 하나의 `Relation`이 됨.
- `Weak Entity Set`의 경우 그것을 구별할 수 있게 하는 외부 속성을 지니게 하여 테이블로 만들어야 함.

## 8장 데이터베이스 설계 이론

### 좋은 스키마와 나쁜 스키마
나쁜 스키마는 세 개의 `anomalies`를 가진다.
- Update anomaly: 한 번 업데이트할 것을 여러 번 해야 하는 경우.
- Delete anomaly: 모든 데이터가 지워져 관련없는 데이터까지 지워지는 경우.
- Insert anomaly: 관련없는 데이터가 삽입되 있는 경우.

### 정규화

#### 정규화가 나온 배경
한 `Relation`에 여러 `Attribute`가 혼합되면 정보가 중복 저장되고, 저장 공간을 낭비하게 된다. 또 중복된 정보로 인해 `갱신 이상`이 발생하게 된다. 동일한 정보를 한 릴레이션에서는 변경하는데, 다른 릴레이션에서 변경하지 않은 경우 어느 것이 정확한 데이터인지 알 수 없게 된다. 이러한 문제를 해결하고자 정규화 과정을 거친다.

#### 정규화란?
관계형 데이터베이스에서 중복을 최소화하기 위해 데이터를 주고화하는 작업. 구체적으로는 불만족스러운 **나쁜** 릴레이션의 애트리뷰트들을 나누어 **좋은** 작은 릴레이션으로 분해하는 작업을 말함. 정규화 작업을 거치게 되면 `정규형`을 만족하게 되는데, `정규형`은 특정 조건을 만족하는 릴레이션의 스키마 형태를 말한다.

#### '나쁜' 릴레이션의 판단 기준
엔티티를 구성하는 애트리뷰트 간 `함수적 종속성(Functional Dependency)`을 통해 판단한다. `함수적 종속성`이란 릴레이션에서 두 개의 애트리뷰트 집합 간 제약의 일종으로 애트리뷰트 **X**의 값 각각에 대해 시간에 관계없이 항상 애트리뷰트 **Y**의 값이 오직 하나만 연관되어 있을 때 **Y**는 **X**에 함수 종속이라 하고, **X** -> **Y**라고 표기한다. **X**를 `결정자(determinant set)`, **Y**를 `종속자(dependent attribute)`라 부른다.

#### 제 1 정규형
애트리뷰트의 도메인이 오직 `원자값`만을 포함하고, 튜플의 모든 애트리뷰트가 도메인에 속하는 하나의 값을 가져야 한다. 즉, 복합 애트리뷰트, 다중값 애트리뷰트, 중첩 릴레이션 등 비 원자적인 애트리뷰트들을 허용하지 않는 릴레이션 형태를 말한다.

#### 제 2 정규형
모든 비주요 애트리뷰트들이 주요 애트리뷰트에 대해서 **완전 함수적 종속이면** 제 2 정규형을 만족한다고 볼 수 있다. 완전 함수적 종속이란 `X -> Y` 라고 가정했을 때, X의 어떠한 애트리뷰트라도 제거하면 더 이상 함수적 종속성이 성립하지 않는 경우를 말한다. 즉, 키가 아닌 열들이 각각 후보키에 대해 결정되는 릴레이션 형태를 말한다.

#### 제 3 정규형
어떠한 비주요 애트리뷰트도 기본키에 대해서 **이행적으로 종속되지 않으면** 제 3 정규형을 만족한다고 볼 수 있다. 이행 함수적 종속이란 `X - >Y`, `Y -> Z`의 경우에 의해서 추론될 수 있는 `X -> Y`의 종속관계를 말한다. 즉, 비주요 애트리뷰트가 비주요 애트리뷰트에 의해 종속되는 경우가 없는 릴레이션 형태를 말한다.

#### BCNF(Boyce-Codd) 정규형
여러 후보 키가 존재하는 릴레이션에 해당하는 정규화 내용이다. 복잡한 식별자 관계에 의해 발생하는 문제를 해결하기 위해 제 3 정규형을 보완하는데 의미가 있다. 비주요 애트리뷰트가 후보키의 일부를 결정하는 분해하는 과정을 말한다.

_각 정규형은 그의 선행 정규형보다 더 엄격한 조건을 갖는다._
* 모든 제 2 정규형 릴레이션은 제 1 정규형을 갖는다.
* 모든 제 3 정규형 릴레이션은 제 2 정규형을 갖는다.
* 모든 BCNF 정규형 릴레이션은 제 3 정규형을 갖는다.

수많은 정규형이 있지만 관계 데이터베이스 설계의 목표는 각 릴레이션이 3NF(or BCNF)를 갖게 하는 것이다.

> 각 정규형은 선행되는 정규형보다 더 엄격한 조건을 가진다. 그러므로 그 이전 정규형을 가진다고 할 수 있다.
